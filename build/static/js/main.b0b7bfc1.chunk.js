(this["webpackJsonpmonday-integration-quickstart-app"]=this["webpackJsonpmonday-integration-quickstart-app"]||[]).push([[0],{32:function(e,t,s){e.exports=s(80)},37:function(e,t,s){},38:function(e,t,s){},80:function(e,t,s){"use strict";s.r(t);var a=s(0),r=s.n(a),n=s(14),o=s.n(n),i=(s(37),s(5)),l=s(6),c=s(1),p=s(8),u=s(7),d=(s(38),s(29)),h=s.n(d),g=s(15),m=s.n(g),f=s(30),v=s.n(f),_=s(31),k=s.n(_)()(),b={default:{text:"Something went wrong, please check the logs",explanation:""},unauthorized:{text:"You are unauthorized. Please enter a valid CircleCI API token.",explanation:'Go to CircleCI and log in. Then click on your profile on the bottom left and go to "Personal API Tokens". Create a new API Token and enter it here at "CircleCI API token" in the settings.'},bad_request:{text:"Error 400: Bad request",explanation:""},no_org_slug:{text:"Please enter your VCS provider. This can be GitHub or BitBucket",explanation:""},form_not_filled:{text:"Please fill in all fields",explanation:"Click the cog icon and fill in all fields to get started."},no_results:{text:"The server returned no results.",explanation:"Did you fill in all values correctly? A possible reason for this error could be that you entered the wrong VCS provider."},workflow_not_found:{text:"This workflow could not be found. Please check the name.",explanation:""},project_not_found:{text:"This project could not be found. Please check the name.",explanation:""}},j={"You must log in first.":"You are unauthorized. Please enter a valid CircleCI API token.","Organization not found":"Organization not found. Please check your organization name."},w={canceled:"remove_circle_outline",failed:"error_outline",success:"check_circle_outline"},y=function(e){Object(p.a)(s,e);var t=Object(u.a)(s);function s(e){var a;return Object(i.a)(this,s),(a=t.call(this,e)).state={settings:{},name:"",errorMessageEnabled:!1,errorMessage:"",errorExplanation:"",projects:{},errorFlipped:!1},a.flipCard=a.flipCard.bind(Object(c.a)(a)),a.selectProject=a.selectProject.bind(Object(c.a)(a)),a.saveSelectedProject=a.saveSelectedProject.bind(Object(c.a)(a)),a.selectWorkflow=a.selectWorkflow.bind(Object(c.a)(a)),a.saveSelectedWorkflow=a.saveSelectedWorkflow.bind(Object(c.a)(a)),a.displayMessage=a.displayMessage.bind(Object(c.a)(a)),a}return Object(l.a)(s,[{key:"componentDidMount",value:function(){var e=this;k.listen("settings",(function(t){e.setState({settings:t.data})}))}},{key:"flipCard",value:function(e){e.preventDefault(),this.setState((function(e){return{errorFlipped:!e.errorFlipped}}))}},{key:"selectProject",value:function(e){this.state.selectedProject!==e?this.setState({selectedProject:e}):this.setState({selectedProject:""})}},{key:"saveSelectedProject",value:function(e){this.setState({saveSelectedProject:e})}},{key:"selectWorkflow",value:function(e){this.state.selectedWorkflow!==e?this.setState({selectedWorkflow:e}):this.setState({selectedWorkflow:""})}},{key:"saveSelectedWorkflow",value:function(e){this.setState({saveSelectedWorkflow:e})}},{key:"displayMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];s?this.setState({errorMessageEnabled:e,errorMessage:b[t].text,errorExplanation:b[t].explanation}):this.setState({errorMessageEnabled:e,errorMessage:t,errorExplanation:""})}},{key:"settingsComplete",value:function(){return null!==this.state.settings.vcs_provider&&0!==this.state.settings.organization_name.length&&0!==this.state.settings.project_name.length&&0!==this.state.settings.workflow_name.length}},{key:"componentDidUpdate",value:function(e,t){var s=this;t.settings!==this.state.settings&&(this.settingsComplete()?fetch("https://circleci.com/api/v2/pipeline?circle-token="+this.state.settings.circleci_api_token+"&org-slug="+this.state.settings.vcs_provider+"/"+this.state.settings.organization_name,{headers:{Accept:"application/json"}}).then((function(e){return 401===e.status&&s.displayMessage(!0,"unauthorized"),e.json()})).then((function(e){if(e.message in j)s.displayMessage(!0,j[e.message],!1);else if(e.items.length>0){var t=e.items;for(var a in s.setState({projects:[]}),t)s.getWorkflow(t[a]);s.displayMessage(!1)}else s.displayMessage(!0,"no_results")})).catch(console.log):this.displayMessage(!0,"form_not_filled"))}},{key:"getWorkflow",value:function(e){var t=this;fetch("https://circleci.com/api/v2/pipeline/"+e.id+"/workflow?circle-token="+this.state.settings.circleci_api_token+"&org-slug="+this.state.settings.vcs_provider+"/"+this.state.settings.organization_name,{headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(s){var a=t.state.projects;for(var r in a[e.project_slug]||(a[e.project_slug]=[]),s.items)a[e.project_slug].push(s.items[r]);t.setState({projects:a})})).catch(console.log)}},{key:"render",value:function(){return this.state.errorMessageEnabled?r.a.createElement("div",{className:"App"},r.a.createElement(E,{message:this.state.errorMessage,explanation:this.state.errorExplanation,errorFlipped:this.state.errorFlipped,flipCard:this.flipCard})):r.a.createElement("div",{className:"app"},r.a.createElement(x,{settings:this.state.settings,projects:this.state.projects}))}}]),s}(r.a.Component),E=function(e){Object(p.a)(s,e);var t=Object(u.a)(s);function s(){return Object(i.a)(this,s),t.apply(this,arguments)}return Object(l.a)(s,[{key:"render",value:function(){return r.a.createElement(m.a,{className:"Tilt Tilt-error",options:{max:20}},r.a.createElement(v.a,{isFlipped:this.props.errorFlipped&&this.props.explanation.length>0},r.a.createElement("div",{onClick:this.props.flipCard,className:"error_message_wrapper"},r.a.createElement("p",{className:"error_message_title"},"Error"),r.a.createElement("p",{className:"error_message_message"},this.props.message),r.a.createElement("img",{alt:"Error",className:"error_message_exclamation_mark",src:"/exclamation_mark.png"})),r.a.createElement("div",{onClick:this.props.flipCard,className:"error_message_wrapper"},r.a.createElement("p",{className:"error_explanation"},this.props.explanation))))}}]),s}(r.a.Component),x=function(e){Object(p.a)(s,e);var t=Object(u.a)(s);function s(e){var a;return Object(i.a)(this,s),(a=t.call(this,e)).state={status:"",errorMessageEnabled:!1,errorMessage:"",errorExplanation:""},a.displayMessage=a.displayMessage.bind(Object(c.a)(a)),a.getStatus=a.getStatus.bind(Object(c.a)(a)),a}return Object(l.a)(s,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){this.getStatus(e,t)}},{key:"displayMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];s?this.setState({errorMessageEnabled:e,errorMessage:b[t].text,errorExplanation:b[t].explanation}):this.setState({errorMessageEnabled:e,errorMessage:t})}},{key:"getStatus",value:function(e,t){var s=this,a=this.props.settings.vcs_provider+"/"+this.props.settings.organization_name+"/"+this.props.settings.project_name,r=this.props.projects[a];if(void 0!==r){var n=r.find((function(e){return e.name===s.props.settings.workflow_name}));void 0===n?e.settings!==this.props.settings&&this.displayMessage(!0,"workflow_not_found"):(this.state.errorMessageEnabled&&this.displayMessage(!1),this.state.status!==n.status&&this.setState({status:n.status}))}else e.settings!==this.props.settings&&this.displayMessage(!0,"project_not_found")}},{key:"render",value:function(){return this.state.errorMessageEnabled?r.a.createElement("div",{className:"App"},r.a.createElement(E,{message:this.state.errorMessage,explanation:this.state.errorExplanation,errorFlipped:this.state.errorFlipped,flipCard:this.flipCard})):r.a.createElement("div",{className:"App"},r.a.createElement(M,{project:this.props.settings.project_name,workflow:this.props.settings.workflow_name,status:this.state.status}))}}]),s}(r.a.Component),M=function(e){Object(p.a)(s,e);var t=Object(u.a)(s);function s(){return Object(i.a)(this,s),t.apply(this,arguments)}return Object(l.a)(s,[{key:"render",value:function(){return r.a.createElement(m.a,{className:"Tilt Tilt-status",options:{max:25},onMouseLeave:this.onMouseLeave},r.a.createElement("p",{className:"status_badge_title"},this.props.project),r.a.createElement("p",{className:"status_badge_subtitle"},this.props.workflow),r.a.createElement("div",{className:"Tilt-inner status_badge_wrapper status_"+this.props.status},r.a.createElement("div",{className:"status_badge_icon"},r.a.createElement(h.a,{icon:w[this.props.status],color:"#FFF"})),r.a.createElement("p",{className:"status_badge_text"},this.props.status)))}}]),s}(r.a.Component),S=y;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.b0b7bfc1.chunk.js.map